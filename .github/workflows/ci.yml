name: Run Tests

# This section defines when the workflow will run.
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

# This section defines the jobs that will be executed.
jobs:
  backend-tests:
    # Use the latest version of Ubuntu as the operating system for the runner.
    runs-on: ubuntu-latest
    defaults:
      run:
        # Set the default working directory for all steps in this job.
        working-directory: ./backend
    steps:
    # Step 1: Check out repository code so the workflow can access it.
    - name: Check out code
      uses: actions/checkout@v3

    # Step 2: Set up the Python environment.
    - name: Set up Python
      uses: actions/setup-python@v3
      with:
        python-version: '3.9' # Specify the Python version you are using.

    # Step 3: Install the backend dependencies from requirements.txt file.
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # Step 4: Run the backend tests using pytest.
    - name: Run tests with pytest
      run: pytest

  # This is the second job, for running frontend tests.
  frontend-tests:
    # Use the latest version of Ubuntu.
    runs-on: ubuntu-latest
    defaults:
      run:
        # Set the default working directory for this job.
        working-directory: ./frontend
    steps:
    # Step 1: Check out the repository code.
    - name: Check out code
      uses: actions/checkout@v3

    # Step 2: Set up the Node.js environment.
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16' 

    # Step 3: Install the frontend dependencies.
    - name: Install dependencies
      run: npm install

    # Step 4: Run the frontend tests using the "test" script from your package.json.
    - name: Run tests with Vitest
      run: npm test
